generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url = env("DATABASE_URL")
}

model autoinfracao {
  id                Int              @id @default(autoincrement())
  data_emissao      DateTime
  id_fiscal         Int
  id_exemplocaso    Int
  descricao         String           @db.Text
  relatoriodiarioId Int?
  fiscal            fiscal           @relation(fields: [id_fiscal], references: [id], onDelete: Cascade)
  exemplocaso       exemplocaso      @relation(fields: [id_exemplocaso], references: [id], onDelete: Cascade)
  relatoriodiario   relatoriodiario? @relation(fields: [relatoriodiarioId], references: [id])

  @@index([id_fiscal], map: "autoinfracao_id_fiscal_fkey")
  @@index([id_exemplocaso], map: "autoinfracao_id_exemplocaso_fkey")
  @@index([relatoriodiarioId], map: "autoinfracao_relatoriodiarioId_fkey")
}

model exemplocaso {
  id              Int            @id @default(autoincrement())
  nome_resumo     String?        @db.Text
  nome_completo   String         @db.Text
  palavra_chave   String?        @db.Text
  categoria       String         @db.Text
  tipo_ocorrencia String?        @db.Text
  tags            String?        @db.Text
  proc_op         String         @db.Text
  proc_adm        String         @db.Text
  enq_pen         String         @db.Text
  enq_adm         String         @db.Text
  modelo          String         @db.Text
  campos          String?        @db.Text
  autoinfracao    autoinfracao[]
}

model fiscal {
  id              Int               @id @default(autoincrement())
  cpf             String            @unique @db.VarChar(100)
  nome            String
  senha           String
  tipo            tipo_usuario
  autoinfracao    autoinfracao[]
  relatoriodiario relatoriodiario[]
}

model relatoriodiario {
  id                               Int            @id @default(autoincrement())
  equipe                           Equipe
  equipe_em_atuacao                String         @db.Text
  orgaos_e_instituicoes_envolvadas String         @db.Text
  responsavel                      String         @db.Text
  data_hora_inicio_acao            DateTime
  data_hora_termino_acao           DateTime
  origem                           Origem
  registro_ocorrencia              Boolean
  area_fiscalizada                 Boolean
  municipios                       String         @db.Text
  setores                          String         @db.Text
  enderecos                        String         @db.Text
  especificacao_local              String         @db.Text
  relatorio                        String         @db.Text
  outras_atividades                String         @db.Text
  coordenadas                      String         @db.Text
  placa_vtr                        String?        @db.Text
  km_inicio                        String?        @db.Text
  km_final                         String?        @db.Text
  condicoes_vtr                    String?        @db.Text
  tipo_acao                        String         @db.Text
  descricao_veiculos               String?        @db.Text
  km_percorrido                    String         @db.Text
  horas_percorridas                String         @db.Text
  createdAt                        DateTime       @default(now())
  processado                       Boolean        @default(false)
  fiscalId                         Int
  tipo_veiculo_abordado            String?        @db.Text
  veiculos_abordados               String?        @db.Text
  autoinfracao                     autoinfracao[]
  fiscal                           fiscal         @relation(fields: [fiscalId], references: [id])

  @@index([fiscalId], map: "relatoriodiario_fiscalId_fkey")
}

enum tipo_usuario {
  Campo
  Administrativo
  Admin
}

enum Equipe {
  charlie_sede_diurno
  charlie_rp_diurno
  charlie_rp_noturno
  delta_sede_diurno
  delta_rp_diurno
  delta_rp_noturno
}

enum Origem {
  rotina
  planejamento_SIMUC
  dejem_SIMUC
  denuncia
  atendimento_orgaos_externos
  demanda_solicitacao_interna
}
